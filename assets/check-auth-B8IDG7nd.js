import{b as u,a as o}from"./index-wYSWI2m-.js";const l="https://www.mku-journal.online",h="accessToken",c="refreshToken",f="/auth/refresh-token",n=u.create({baseURL:l,withCredentials:!0}),k=()=>o.get(h)||null,d=()=>o.get(c)||null,p=(e,t)=>{o.set(h,e,{path:"/"}),o.set(c,t,{path:"/",expires:1})};n.interceptors.request.use(e=>{const t=k();return t&&e.headers&&(e.headers.authorization=`${t}`),e},e=>Promise.reject(e));let i=!1,a=[];const m=e=>{a.push(e)},w=e=>{a.forEach(t=>t(e)),a=[]};n.interceptors.response.use(e=>e,async e=>{const t=e.config;if(e.response?.status===401&&!t._retry){if(i)return new Promise(s=>{m(r=>{t.headers&&(t.headers.authorization=`${r}`),s(n(t))})});t._retry=!0,i=!0;try{const s=d();if(!s)throw new Error("No refresh token available");const{data:r}=await n.post(f,{[c]:s});return p(r.accessToken,r.refreshToken),w(r.accessToken),t.headers&&(t.headers.authorization=`${r.accessToken}`),n(t)}catch(s){return Promise.reject(s)}finally{i=!1}}return Promise.reject(e)});function E(){const e=o.get("accessToken"),t=window.location.pathname;if(!e&&!t.includes("/login.html")&&!t.includes("/registration.html")){window.location.href="/Vitamin/login.html";return}e&&(t.includes("/login.html")||t.includes("/registration.html"))&&(window.location.href="/Vitamin")}export{n as a,E as c};
