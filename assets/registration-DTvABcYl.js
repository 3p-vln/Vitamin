import"./style-CqQXtvE4.js";import{J as m}from"./just-validate.es-C73wyOde.js";import{a as g,A as f}from"./index-wYSWI2m-.js";import{a as c,c as h}from"./check-auth-B8IDG7nd.js";function p(){const r=document.getElementById("wholesale-registration-file"),t=document.getElementById("wholesale-registration-file-description-pc"),e=document.getElementById("wholesale-registration-file-name"),a=document.getElementById("registration-add-file-btn"),i=document.getElementById("wholesale-registration-submit-btn");r&&r.addEventListener("change",()=>{if(r.files&&r.files.length>0)if(window.innerWidth>=567&&t){const s=r.files[0].name,n=30,o=s.length>n?s.slice(0,n)+"...":s;e.textContent=o}else{const s=r.files[0].name,n=30,o=s.length>n?s.slice(0,n)+"...":s;e.textContent=o,e.style.opacity="1"}}),a&&r&&a.addEventListener("click",()=>{r.click()}),r&&i&&r.addEventListener("change",()=>{i.classList.remove("registration-form__submit_disabled"),i.disabled=!1})}function v(){const r=document.getElementById("auth-card"),t=document.getElementById("regular-reg"),e=document.getElementById("wholesale-reg"),a=document.querySelector(".registration-form__error-message"),i=document.querySelector(".registration__container");if(r&&t&&e){t.addEventListener("click",()=>{e.classList.remove("registration__nav-btn_active"),t.classList.add("registration__nav-btn_active"),r.classList.add("flipped");const n=document.getElementById("regular-registration");n instanceof HTMLFormElement&&n.reset(),a instanceof HTMLSpanElement&&(a.innerText="");const o=document.querySelectorAll(".just-validate-error-label");o&&o.forEach(l=>{l.remove()}),i instanceof HTMLDivElement&&(i.style.height="890px")}),e.addEventListener("click",()=>{e.classList.add("registration__nav-btn_active"),t.classList.remove("registration__nav-btn_active"),r.classList.remove("flipped");const n=document.getElementById("wholesale-registration");n instanceof HTMLFormElement&&n.reset();const o=document.getElementById("wholesale-registration-file-name");o&&(o.innerHTML="Permission",o.style.opacity="0.3");const l=document.getElementById("wholesale-registration-file-description-pc");l&&(l.innerHTML="Wholesale purchase permission",l.style.opacity="0.3");const u=document.getElementById("wholesale-registration-submit-btn");u instanceof HTMLButtonElement&&(u.disabled=!0,u.classList.add("registration-form__submit_disabled")),a instanceof HTMLSpanElement&&(a.innerText=""),i instanceof HTMLDivElement&&(i.style.height="950px")});const s=document.querySelectorAll(".just-validate-error-label");s&&s.forEach(n=>{n.remove()})}}async function d(r){try{const e=await c.post("/auth/register",r);e.status===201&&g.set("refreshToken",e.data.user.refreshToken,{path:"/"})}catch(e){if(e instanceof f&&e.response){const a=document.querySelector(".registration-form__regular-error-message");a&&(e.response.data.message==="Користувач вже зареєстрований"?a.innerHTML="The user is already registered":a.innerHTML="Error, try again later")}return}const t=await c.get("/profile/info");"email"in t.data&&(localStorage.setItem("userInfo",JSON.stringify(t.data)),window.location.href="/Vitamin")}function y(){new m("#regular-registration").addField("#regular-registration-email",[{rule:"required",errorMessage:"Email is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9а-яА-Я."_%+-]+@[a-zA-Zа-яА-Я0-9-.]+\.[a-zA-Zа-яА-Я]{2,}$/u,errorMessage:"Enter a valid email address!"}]).addField("#regular-registration-first-name",[{rule:"required",errorMessage:"Name required"},{rule:"minLength",value:2,errorMessage:"The name must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"The name must not exceed 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"The name must contain only letters"}]).addField("#regular-registration-last-name",[{rule:"required",errorMessage:"Last name required"},{rule:"minLength",value:2,errorMessage:"Last name must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"Last name must not exceed 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"The name must contain only letters"}]).addField("#regular-registration-password",[{rule:"required",errorMessage:"Password required"},{rule:"minLength",value:8,errorMessage:"Password must contain a minimum of 8 characters"},{rule:"maxLength",value:50,errorMessage:"Password must not exceed 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"Must contain uppercase ,lowercase letter, and number"}]).onSuccess(async()=>{const t=document.getElementById("regular-registration"),e=new FormData(t),a={role_type:"regular"};for(let[i,s]of e.entries())a[i]=s;await d(a)})}function L(){new m("#wholesale-registration").addField("#wholesale-registration-email",[{rule:"required",errorMessage:"Email is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9а-яА-Я."_%+-]+@[a-zA-Zа-яА-Я0-9-.]+\.[a-zA-Zа-яА-Я]{2,}$/u,errorMessage:"Enter a valid email address!"}]).addField("#wholesale-registration-first-name",[{rule:"required",errorMessage:"First name is required"},{rule:"minLength",value:2,errorMessage:"First name must be at least 2 characters"},{rule:"maxLength",value:30,errorMessage:"First name must be at most 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"First name must contain only letters"}]).addField("#wholesale-registration-last-name",[{rule:"required",errorMessage:"Last name is required"},{rule:"minLength",value:2,errorMessage:"Last name must be at least 2 characters"},{rule:"maxLength",value:30,errorMessage:"Last name must be at most 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"Last name must contain only letters"}]).addField("#wholesale-registration-password",[{rule:"required",errorMessage:"Password is required"},{rule:"minLength",value:8,errorMessage:"Password must be at least 8 characters"},{rule:"maxLength",value:50,errorMessage:"Password must be at most 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"Must contain uppercase ,lowercase letter, and number"}]).addField("#wholesale-registration-file",[{rule:"required",errorMessage:"File is required"},{validator:()=>{const t=document.querySelector("#wholesale-registration-file");return!t.files||t.files.length===0?!1:["image/jpeg","image/png","image/webp"].includes(t.files[0].type)},errorMessage:"Only image(JPG, PNG, webp) are allowed"}]).onSuccess(async()=>{const t=document.getElementById("wholesale-registration"),e=new FormData(t),a={role_type:"whosale"};for(let[i,s]of e.entries())a[i]=s;await d(a)})}document.addEventListener("DOMContentLoaded",async()=>{p(),v(),y(),L(),h()});
