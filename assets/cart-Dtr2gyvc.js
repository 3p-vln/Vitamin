import{g as s,a as v,c as u,r as l}from"./use-call-dom-DDNnwvp7.js";import{i as q}from"./dropdown-7a_ekS_C.js";import{j as $}from"./use-api-AcE-7l2M.js";import{s as H}from"./scroll-lock-DIYiYMmB.js";async function G(t){let e=null;if(typeof t=="string"?e=s(t):e=t,!e)return;const o=s(".counter__plus",e),n=s(".counter__minus",e),i=s(".counter__items",e);let r=Number(i?.innerText);!i||!o||!n||(T(o,n,r),n.addEventListener("click",()=>{K(i,r),r=Number(i?.innerText),T(o,n,r)}),o.addEventListener("click",()=>{Q(i,r),r=Number(i?.innerText),T(o,n,r)}),L(i,r))}function L(t,e){t.textContent=e.toString()}function K(t,e){e>1&&(e--,L(t,e))}function Q(t,e){e<999&&(e++,L(t,e))}function T(t,e,o){o!==999&&o!==1&&(t.style.opacity="1",e.style.opacity="1"),o===999&&(t.style.opacity="0.3"),o===1&&(e.style.opacity="0.3")}const A=s(".header__bag"),y=s(".cart"),B=s(".cart__close"),J=s(".cart__bg"),f=s(".cart__items"),F=JSON.parse(localStorage.getItem("userInfo")||"[]");let R=v(".prod"),p,N=0;const C=s(".info__backbtn");async function lt(){!A||!B||!J||!f||(A.addEventListener("click",t=>X(t)),B.addEventListener("click",()=>M()),J.addEventListener("click",()=>M()),S(),_(),R.forEach(t=>{const e=s(".prod__autoship-text",t);e&&ot(e)}))}function X(t){t.stopPropagation(),y&&(u(y,"add","cart_active"),C&&(C.style.zIndex="1"),H.disablePageScroll(),U())}function M(){y&&(u(y,"remove","cart_active"),C&&(C.style.zIndex="25"),U(),H.enablePageScroll())}function U(){const t=s(".header"),e=s("html");if(!(!t||!e||!y)){if(y.classList.contains("cart_active")){N=window.scrollY,document.body.style.position="fixed",document.body.style.top=`-${N}px`,document.body.style.left="0",document.body.style.width="100%",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.backgroundColor="white",t.style.paddingRight=`${Z()}px`;return}document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.width="",document.documentElement.style.scrollBehavior="auto",window.scrollTo({top:N,behavior:"instant"}),document.documentElement.style.scrollBehavior="",t.style.top="",t.style.left="",t.style.position="",t.style.backgroundColor="",t.style.paddingRight="0"}}function Z(){const t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),e}function tt(t){let e=JSON.parse(localStorage.getItem("cartItems")||"[]");e.some(n=>n.id===t)&&e.forEach(async n=>{if(n.id===t){const i=s(`.prod_${n.id}`);if(!i)return;const r=s(".prod__close",i);if(!r)return;r.addEventListener("click",()=>{i.remove(),et(t)})}})}function et(t){let e=JSON.parse(localStorage.getItem("cartItems")||"[]");if(e=e.filter(o=>o.id!==t),localStorage.setItem("cartItems",JSON.stringify(e)),_(),g(),e.length===0){if(s(".cart__empty"))return;p=!0,x(p),_();return}}function ot(t){window.innerWidth<768&&(t.innerText="Deliver every")}function b(t,e=!1,o="30",n=1){if(!f)return;const i=l("div",["cart__item","prod",`prod_${t.id}`]),r=l("a","prod__img");r.href=`/one-product.html?id=${t.id}`,t.type==="Vitamins & Dietary Supplements"&&u(r,"add","prod__img_purple"),t.type==="Minerals"&&u(r,"add","prod__img_green-mint"),t.type==="Prenatal Vitamins"&&u(r,"add","prod__img_pink"),t.type==="Pain Relief"&&u(r,"add","prod__img_blue"),t.type==="Antioxidants"&&u(r,"add","prod__img_orange"),t.type==="Weight Loss"&&u(r,"add","prod__img_dark-blue"),(t.type==="Probiotics"||t.type==="Sale%")&&u(r,"add","prod__img_red"),r.innerHTML=`
    <picture>
      <source srcset="${t.img.img_webp}" type="image/webp">
      <img src="${t.img.img_default}" alt="prod" width="${t.img.img_width}" height="${t.img.img_height}" />
    </picture>`;const c=l("div","prod__info"),a=l("div","prod__title-and-close"),d=l("a","prod__title");d.href=`/one-product.html?id=${t.id}`,d.innerText=t.name;const h=l("div","prod__close");h.innerHTML=`
    <span></span>
    <span></span>
  `;const k=l("div","prod__counter-and-price"),w=l("div","prod__counter");w.innerHTML=`
    <button class="counter__minus">
      <svg>
        <use href="#minus"></use>
      </svg>
    </button>
    <p class="counter__items">${n}</p>
    <button class="counter__plus">
      <svg>
        <use href="#plus"></use>
      </svg>
    </button>
  `,G(w);const I=l("p","prod__price"),j=P(t.price,t.discount,n),O=D(t.price,n);t.type==="Sale%"?(u(I,"add","prod__price_sale"),I.innerHTML=`<span>$${O}</span> $${j}`):I.innerText=`$${O}`;const E=l("div","prod__autoship");E.innerHTML=`
    <div class="prod__checkbox">
      <input type="checkbox" name="autoship" ${e?"checked":""}/>
      <span></span>
    </div>
    <p class="prod__autoship-text">Autoship every</p>
    <div class="dropdown">
      <div class="dropdown__box">
        <p class="dropdown__text">${o}</p>
        <div class="dropdown__arrow">
          <svg>
            <use href="#back-arrow"></use>
          </svg>
        </div>
      </div>
      <div class="dropdown__list">
        <button class="dropdown__item">10</button>
        <button class="dropdown__item">20</button>
        <button class="dropdown__item">30</button>
        <button class="dropdown__item">40</button>
        <button class="dropdown__item">50</button>
        <button class="dropdown__item">60</button>
      </div>
    </div>
    days
  `,q(E),a.appendChild(d),a.appendChild(h),k.appendChild(w),k.appendChild(I),c.appendChild(a),c.appendChild(k),c.appendChild(E),i.appendChild(r),i.appendChild(c),f.appendChild(i),p=!1,x(p);const V=s(".autoship__on-off"),Y=s(".count__items");!V||!Y?rt(t):nt(t,e,o,n),tt(t.id),z(t)}function P(t,e,o){const n=parseFloat(t);if(isNaN(n))throw new Error("Invalid price format");return(n*(1-e/100)*o).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function D(t,e){const o=parseFloat(t);if(isNaN(o))throw new Error("Invalid price format");return(o*e).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function nt(t,e,o,n){let i=JSON.parse(localStorage.getItem("cartItems")||"[]");i.some(c=>c.id===t.id)||i.push({id:t.id,autoshipChecked:e,autoshipDays:o,counts:n}),localStorage.setItem("cartItems",JSON.stringify(i))}function rt(t){let e=JSON.parse(localStorage.getItem("cartItems")||"[]");e.some(n=>n.id===t.id)||e.push({id:t.id,autoshipChecked:!0,autoshipDays:"30",counts:1}),localStorage.setItem("cartItems",JSON.stringify(e))}function z(t){const e=s(`.prod_${t.id} .prod__checkbox input`),o=s(`.prod_${t.id} .dropdown__text`),n=v(`.prod_${t.id} .dropdown__item`),i=s(`.prod_${t.id} .counter__minus`),r=s(`.prod_${t.id} .counter__plus`),c=s(`.prod_${t.id} .counter__items`);!e||!o||!n||!i||!r||!c||(e&&e.addEventListener("change",()=>{m(`${t.id}`,e.checked,o.textContent||"30",Number(c.textContent))}),o&&n.forEach(a=>{a.addEventListener("click",d=>{const h=d.target.textContent||"30";m(`${t.id}`,e.checked,h,Number(c.textContent))})}),i.addEventListener("click",()=>{W(t,Number(c.textContent)),m(`${t.id}`,e.checked,o.textContent||"30",Number(c.textContent)),_()}),r.addEventListener("click",()=>{W(t,Number(c.textContent)),m(`${t.id}`,e.checked,o.textContent||"30",Number(c.textContent)),_()}))}function W(t,e){const o=P(t.price,t.discount,e),n=D(t.price,e),i=s(`.prod_${t.id} .prod__price`);i&&(t.type==="Sale%"?i.innerHTML=`<span>$${n}</span> $${o}`:i.innerText=`$${n}`)}function m(t,e,o,n){let i=JSON.parse(localStorage.getItem("cartItems")||"[]");const r=i.findIndex(c=>c.id===Number(t));r!==-1&&(i[r].autoshipChecked=e,i[r].autoshipDays=o,i[r].counts=n),localStorage.setItem("cartItems",JSON.stringify(i))}function S(){const t=JSON.parse(localStorage.getItem("cartItems")||"[]");if(t.length===0){p=!0,x(p),g();return}p=!1,x(p),g(),f&&(f.innerHTML="",t.forEach(async e=>{try{const o=await $(`${e.id}`);if("errors"in o){console.error(o.errors);return}b(o,e.autoshipChecked,e.autoshipDays,e.counts),z(o),R=v(".prod")}catch(o){console.error(o)}}))}function ut(t){let e=JSON.parse(localStorage.getItem("cartItems")||"[]");e.length===0&&(p=!0,x(p)),e.some(n=>n.id===t.id)||b(t),_(),g()}function pt(t){if(!t.disabled_subscribe)return;const e=s(`.prod_${t.id} .prod__checkbox input`),o=s(`.prod_${t.id} .dropdown__text`),n=s(".autoship__dropdown .dropdown__text");if(!n)return;const i=n.textContent,r=s(`.prod_${t.id} .counter__items`);!e||!o||!i||!r||(e.checked=!0,o.innerText=i,m(`${t.id}`,e.checked,o.textContent||"30",Number(r.textContent)))}function mt(t){if(!t.disabled_subscribe)return;const e=s(`.prod_${t.id} .prod__checkbox input`),o=s(`.prod_${t.id} .dropdown__text`),n=s(`.prod_${t.id} .counter__items`);!e||!o||!n||(e.checked=!1,m(`${t.id}`,e.checked,o.textContent||"30",Number(n.textContent)))}function _t(t){const e=s(`.prod_${t.id} .prod__checkbox input`),o=s(`.prod_${t.id} .dropdown__text`),n=s(`.prod_${t.id} .counter__items`),i=s(".count__counter .counter__items");let r=JSON.parse(localStorage.getItem("cartItems")||"[]");r.length===0&&(p=!0,x(p));const c=r.some(d=>d.id===t.id);if(!i)return;if(!c){b(t,!1,"30",Number(i.innerText)),_(),g();return}if(!e||!o||!n)return;const a=Number(n.textContent)+Number(i.innerText);a>999||a==999?m(`${t.id}`,e.checked,o.textContent||"30",999):m(`${t.id}`,e.checked,o.textContent||"30",a),S(),_()}function x(t){if(f&&(t||(u(f,"remove","empty"),v(".cart__empty").forEach(o=>o.remove())),t)){const e=l("p","cart__empty");e.innerText="Your cart is empty",u(f,"add","empty"),f.appendChild(e)}}function _(){let t=JSON.parse(localStorage.getItem("cartItems")||"[]"),e=0,o;const n=s("#total-cart-price");n&&(t?.length===0&&(n.innerText="$0"),t.forEach(async i=>{try{const r=await $(`${i.id}`);if("errors"in r){console.error(r.errors);return}r.type==="Sale%"?o=P(r.price,r.discount,i.counts):o=D(r.price,i.counts),e+=parseFloat(o.replace(/,/g,"").replace(/\s/g,"")),n.innerText=`$${e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,it(e)}catch(r){console.error(r)}}))}function it(t){const e=s(".cart__btn");if(!e)return;const o=s(".btn",e);if(!(!F||!o)&&F.role_type==="whosale"){o.style.backgroundColor="#C3BDB6",o.style.pointerEvents="none";const n=l("p","cart__limit");n.style.marginTop="15px",n.style.textAlign="center",n.style.opacity="0.5",n.style.fontSize="14px",n.style.fontWeight="400",n.innerText="Minimum order amount is $700",s(".cart__limit")||e.appendChild(n),t>=700&&(o.style.backgroundColor="",o.style.pointerEvents="")}}function g(){const t=s(".cart__btn");if(!t)return;const e=s(".btn",t);if(!e)return;if(JSON.parse(localStorage.getItem("cartItems")||"[]").length===0){e.style.backgroundColor="#C3BDB6",e.style.pointerEvents="none";return}e.style.backgroundColor="",e.style.pointerEvents=""}async function ft(t){for(const e of t)try{let o=JSON.parse(localStorage.getItem("cartItems")||"[]");const n=await $(e);if("errors"in n){console.error(n);return}const i=s(`.prod_${n.id} .prod__checkbox input`),r=s(`.prod_${n.id} .dropdown__text`);if(!o.some(h=>h.id===n.id)){b(n,!0,"30",1),_(),g();continue}const a=s(`.prod_${n.id} .counter__items`);if(!i||!r||!a)return;const d=Number(a.textContent)+1;d>=999?m(`${n.id}`,i.checked,r.textContent||"30",999):m(`${n.id}`,i.checked,r.textContent||"30",d),S(),_()}catch(o){console.error(o)}}async function ht(t){for(const e of t)try{let o=JSON.parse(localStorage.getItem("cartItems")||"[]");const n=await $(e.id);if("errors"in n){console.error(n);return}const i=s(`.prod_${n.id} .prod__checkbox input`),r=s(`.prod_${n.id} .dropdown__text`);if(!o.some(h=>h.id===n.id)){b(n,!1,"30",e.counts),_(),g();continue}const a=s(`.prod_${n.id} .counter__items`);if(!i||!r||!a)return;const d=Number(a.textContent)+e.counts;d>=999?m(`${n.id}`,i.checked,r.textContent||"30",999):m(`${n.id}`,i.checked,r.textContent||"30",d),S(),_()}catch(o){console.error(o)}}export{ft as a,ht as b,X as c,ut as d,pt as e,G as f,_t as g,P as h,lt as i,D as j,mt as r};
