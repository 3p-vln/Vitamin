import{g as s,c as u,a as c}from"./use-call-dom-CaqOo_cc.js";/* empty css              */import"./check-auth-CB7tDQ7V.js";import{a as p}from"./js.cookie-Cz0CWeBA.js";import{r as v,a as w}from"./use-api-Bg0RsZwB.js";import{J as d}from"./just-validate.es-C73wyOde.js";function b(){const r=s("#wholesale-registration-file"),e=s("#wholesale-registration-file-description-pc"),a=s("#wholesale-registration-file-name"),t=s("#registration-add-file-btn"),n=s("#wholesale-registration-submit-btn");r instanceof HTMLInputElement&&r.addEventListener("change",()=>{if(r.files&&r.files.length>0)if(window.innerWidth>=567&&e){const o=r.files[0].name,i=30,l=o.length>i?o.slice(0,i)+"...":o;e.textContent=l}else{const o=r.files[0].name,i=30,l=o.length>i?o.slice(0,i)+"...":o;a.textContent=l,a.style.opacity="1"}}),t&&r&&t.addEventListener("click",()=>{r.click()}),r&&n instanceof HTMLButtonElement&&r.addEventListener("change",()=>{u(n,"remove","registration-form__submit_disabled"),n.disabled=!1})}function M(){const r=s("#auth-card"),e=s("#regular-reg"),a=s("#wholesale-reg"),t=c(".registration-form__error-message"),n=s(".registration__container");r&&e&&a&&(e.addEventListener("click",()=>{u(a,"remove","registration__nav-btn_active"),u(e,"add","registration__nav-btn_active"),u(r,"add","flipped");const i=s("#regular-registration");i&&i.reset(),t.forEach(m=>{m.innerText=""}),c(".just-validate-error-label").forEach(m=>{m.remove()}),n&&(n.style.height="890px")}),a.addEventListener("click",()=>{u(a,"add","registration__nav-btn_active"),u(e,"remove","registration__nav-btn_active"),u(r,"remove","flipped");const i=s("#wholesale-registration");i&&i.reset();const l=s("#wholesale-registration-file-name");l&&(l.innerHTML="Permission",l.style.opacity="0.3");const m=s("#wholesale-registration-file-description-pc");m&&(m.innerHTML="Wholesale purchase permission",m.style.opacity="0.3");const g=s("#wholesale-registration-submit-btn");g&&(g.disabled=!0,u(g,"add","registration-form__submit_disabled")),t.forEach(h=>{h.innerText=""}),n&&(n.style.height="950px")}),c(".just-validate-error-label").forEach(i=>{i.remove()}))}async function f(r){const e=await v(r);if(!("errors"in e)){p.set("refreshToken",e.user.refreshToken,{path:"/"});const t=await w();localStorage.setItem("userInfo",JSON.stringify(t)),window.location.href="/Vitamin";return}const a=c(".registration-form__error-message");if(a)switch(e.errors[0].message){case"Користувач вже зареєстрований":a.forEach(t=>{t.innerHTML="The user is already registered"});break;default:a.forEach(t=>{t.innerHTML="Error, try again later"})}}function L(){new d("#wholesale-registration",{fallback:!1}).addField("#wholesale-registration-email",[{rule:"required",errorMessage:"Email is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9а-яА-Я."_%+-]+@[a-zA-Zа-яА-Я0-9-.]+\.[a-zA-Zа-яА-Я]{2,}$/u,errorMessage:"Enter a valid email address!"}]).addField("#wholesale-registration-first-name",[{rule:"required",errorMessage:"First name is required"},{rule:"minLength",value:2,errorMessage:"First name must be at least 2 characters"},{rule:"maxLength",value:30,errorMessage:"First name must be at most 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"First name must contain only letters"}]).addField("#wholesale-registration-last-name",[{rule:"required",errorMessage:"Last name is required"},{rule:"minLength",value:2,errorMessage:"Last name must be at least 2 characters"},{rule:"maxLength",value:30,errorMessage:"Last name must be at most 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"Last name must contain only letters"}]).addField("#wholesale-registration-password",[{rule:"required",errorMessage:"Password is required"},{rule:"minLength",value:8,errorMessage:"Password must be at least 8 characters"},{rule:"maxLength",value:50,errorMessage:"Password must be at most 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"Must contain uppercase, lowercase letter, and number"}]).addField("#wholesale-registration-file",[{rule:"required",errorMessage:"File is required"},{validator:()=>{const e=s("#wholesale-registration-file");return!e||!e.files||e.files.length===0?!1:["image/jpeg","image/png","image/webp"].includes(e.files[0].type)},errorMessage:"Only image (JPG, PNG, webp) are allowed"}]).onSuccess(async()=>{const e=s("#wholesale-registration");if(!e)return;s('#wholesale-registration button[type="submit"]',e)?.removeAttribute("data-just-validate-fallback-disabled");const t=new FormData(e),n={role_type:"whosale",email:t.get("email")?.toString()??"",first_name:t.get("first_name")?.toString()??"",last_name:t.get("last_name")?.toString()??"",password:t.get("password")?.toString()??""};await f(n)})}function _(){new d("#regular-registration").addField("#regular-registration-email",[{rule:"required",errorMessage:"Email is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9а-яА-Я."_%+-]+@[a-zA-Zа-яА-Я0-9-.]+\.[a-zA-Zа-яА-Я]{2,}$/u,errorMessage:"Enter a valid email address!"}]).addField("#regular-registration-first-name",[{rule:"required",errorMessage:"Name required"},{rule:"minLength",value:2,errorMessage:"The name must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"The name must not exceed 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"The name must contain only letters"}]).addField("#regular-registration-last-name",[{rule:"required",errorMessage:"Last name required"},{rule:"minLength",value:2,errorMessage:"Last name must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"Last name must not exceed 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"The name must contain only letters"}]).addField("#regular-registration-password",[{rule:"required",errorMessage:"Password required"},{rule:"minLength",value:8,errorMessage:"Password must contain a minimum of 8 characters"},{rule:"maxLength",value:50,errorMessage:"Password must not exceed 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"Must contain uppercase, lowercase letter, and number"}]).onSuccess(async()=>{const e=s("#regular-registration");if(!e)return;const a=new FormData(e),t={role_type:"regular",email:a.get("email")?.toString()??"",first_name:a.get("first_name")?.toString()??"",last_name:a.get("last_name")?.toString()??"",password:a.get("password")?.toString()??""};await f(t)})}document.addEventListener("DOMContentLoaded",()=>{b(),M(),_(),L()});
