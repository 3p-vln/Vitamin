import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css                */import{a as n}from"./api-client-DfWh3B4B.js";import{J as i}from"./just-validate.es-C73wyOde.js";import"./js.cookie-Cj7aMn_Q.js";async function l(){const o=new URL(window.location.href),e=document.querySelector(".recover__message"),s=document.querySelector(".custom-loader"),r=document.getElementById("reset-password-form"),t=o.searchParams.get("reset");if(t&&e)try{(await n.get(`/auth/check-reset-token?token=${t}`)).status===200&&s&&r&&(s.style.display="none",r.style.display="block")}catch(a){const c=a;switch(s&&r&&(s.style.display="none",e.style.opacity="1"),c.status){case 400:e.innerText="Incorrect reference. The password has not been changed.",e.style.color="red";break;case 403:e.innerText="The time for change has expired. The password has not been changed.",e.style.color="red";break;default:e.innerText="Something went wrong... Try again later.",e.style.color="red";break}}else console.error("Токен не найден в URL")}async function d(o){const e=document.querySelector(".recover__message"),s=document.querySelector(".recover__form_new-password");try{const r=await n.post("/auth/set-new-password",o);console.log(r),r.status===200&&e&&s&&(s.remove(),e.innerHTML='The password was successfully changed  <a class="recover__link-login" href="/Vitamin/login.html"> Back to login</a>',e.classList.remove("recover__message_hidden"),e.style.color="green")}catch(r){switch(r.status){case 400:e&&(e.innerHTML='Oops. Error, the password has not been changed. Try again later.<a class="recover__link-login" href="/Vitamin/login.html"> Back to login</a>',e.classList.remove("recover__message_hidden"),e.style.color="red")}}}function m(){new i("#reset-password-form").addField("#reset-password",[{rule:"required",errorMessage:"Password required"},{rule:"minLength",value:8,errorMessage:"Password must contain a minimum of 8 characters"},{rule:"maxLength",value:50,errorMessage:"Password must not exceed 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"Must contain uppercase ,lowercase letter, and number"}]).onSuccess(async()=>{const s=new URL(window.location.href).searchParams.get("reset"),r=document.getElementById("reset-password");r instanceof HTMLInputElement&&s&&await d({resetToken:s,newPassword:r.value})})}document.addEventListener("DOMContentLoaded",async()=>{await l(),m()});
