import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{g as t,r as c,c as l}from"./use-call-dom-DDNnwvp7.js";import{h as O,j as k,i as z}from"./cart-CkkIn26D.js";import{a as R,m as J}from"./use-api-DTQNp6K8.js";import{J as U}from"./just-validate.es-C73wyOde.js";import{I as q}from"./index-yFKSUj0c.js";import{s as V,r as A}from"./stopPreload-BW9xUuEZ.js";const w=t(".order-list__prods"),_=t(".order-list__total");function B(){W(),j()}function W(){const r=JSON.parse(localStorage.getItem("cartItems")||"[]");r.length!==0&&w&&(w.innerHTML="",r.forEach(s=>{Z(s)}))}async function Z(r){if(!w)return;const s=c("div",["prod",`prod_${r.id}`]),e=c("div","prod__img");try{const a=await R(`${r.id}`);if("errors"in a){console.error(a.errors);return}a.type==="Vitamins & Dietary Supplements"&&l(e,"add","prod__img_purple"),a.type==="Minerals"&&l(e,"add","prod__img_green-mint"),a.type==="Prenatal Vitamins"&&l(e,"add","prod__img_pink"),a.type==="Pain Relief"&&l(e,"add","prod__img_blue"),a.type==="Antioxidants"&&l(e,"add","prod__img_orange"),a.type==="Weight Loss"&&l(e,"add","prod__img_dark-blue"),(a.type==="Probiotics"||a.type==="Sale%")&&l(e,"add","prod__img_red"),e.innerHTML=`
    <img src="${a.img}" alt="" />
  `;const h=c("div","prod__count-and-name");h.innerText=`${r.counts} x ${a.name}`;const d=c("p","prod__price"),$=O(a.price,a.discount,r.counts),g=k(a.price,r.counts);a.type==="Sale%"?(l(d,"add","prod__price_sale"),d.innerHTML=`<span>$${g}</span> $${$}`):d.innerText=`$${g}`,s.appendChild(e),s.appendChild(h),s.appendChild(d),w.appendChild(s)}catch(a){console.error(a)}}function j(){if(!_)return;let r=JSON.parse(localStorage.getItem("cartItems")||"[]"),s=0,e,a=0;const h=c("p","order-list__subtotal"),d=c("p","order-list__shopping"),$=c("p","order-list__discount"),g=c("p","order-list__todays-total"),D=t(".accordion__price");r?.length===0&&(g.innerHTML="Today’s Total: <span>$0</span>"),r.forEach(async v=>{try{const n=await R(`${v.id}`);if("errors"in n){console.error(n.errors);return}if(n.type==="Sale%"?(e=O(n.price,n.discount,v.counts),a+=parseFloat(k(n.price,v.counts).replace(/,/g,"").replace(/\s/g,""))-parseFloat(O(n.price,n.discount,v.counts).replace(/,/g,"").replace(/\s/g,""))):e=k(n.price,v.counts),s+=parseFloat(e.replace(/,/g,"").replace(/\s/g,"")),h.innerHTML=`Subtotal <span>$${s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,_.appendChild(h),a!==0&&($.innerHTML=`Discount <span class="red">-$${a.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,_.appendChild($)),d.innerHTML="Shipping <span>$9.20</span>",_.appendChild(d),s+=9.2,g.innerHTML=`Today’s Total: <span>$${s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,_.appendChild(g),!D)return;D.innerText=`$${s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}catch(n){console.log(n)}})}const C=t(".accordion"),N=t(".accordion-content");function Y(){!C||!N||C.addEventListener("click",()=>{C.classList.toggle("accordion_active"),N.classList.toggle("accordion-content_active")})}const f=t(".header");function G(){K()}function K(){E(),window.addEventListener("scroll",E)}function E(){f&&(window.scrollY>50?(f.style.backgroundColor="white",f.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.1)",f.style.transition="background-color 0.3s ease, box-shadow 0.3s ease"):(f.style.backgroundColor="transparent",f.style.boxShadow="none"))}async function Q(){return new Promise(r=>{const s=t("#create-order");if(!s)return;const e=new U(s,{focusInvalidField:!0,lockForm:!1,validateBeforeSubmitting:!0});e.addField("#first-name",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Only letters are allowed"}]).addField("#last-name",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Only letters are allowed"}]).addField("#address-line1",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:5,errorMessage:"Must be at least 5 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}\d.,\s]+$/u,errorMessage:"Write correct address"}]).addField("#address-line2",[{rule:"minLength",value:5,errorMessage:"Must be at least 5 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}\d.,\s]+$/u,errorMessage:"Write correct address"}]).addField("#city",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Enter a valid city name"}]).addField("#state",[{rule:"required",errorMessage:"This field is required"}]).addField("#zip",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:3,errorMessage:"Must be at least 3 characters"},{rule:"maxLength",value:10,errorMessage:"Must be less than 10 characters"},{rule:"customRegexp",value:/^\d+$/,errorMessage:"Enter a valid ZIP / Postal Code"}]).addField("#mail",[{rule:"required",errorMessage:"This field is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z]{2,})$/,errorMessage:"Write correct email"}]).addField("#phone",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:4,errorMessage:"Must be at least 4 characters"},{rule:"maxLength",value:15,errorMessage:"Must be less than 15 characters"},{rule:"customRegexp",value:/^\+?\d+$/,errorMessage:"Enter a valid phone number"}]).addField("#card",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:19,errorMessage:"Must be at least 16 characters"}]).addField("#expiration",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:5,errorMessage:"Must be at least 4 characters"}]).addField("#cvc",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:3,errorMessage:"Must be at least 3 characters"}]),e.validate(),e.onSuccess(()=>r(!0)),e.onFail(()=>r(!1))})}const P=t(".create-order-form__btn"),H=t(".order-list__btn"),o=JSON.parse(localStorage.getItem("userInfo")||"[]"),i=JSON.parse(localStorage.getItem("orderInfo")||"[]"),M=t("#first-name"),L=t("#last-name"),I=t("#address-line1"),y=t("#address-line2"),S=t("#city"),b=t("#state"),x=t("#zip"),T=t("#mail"),F=t("#phone"),u=t("#card"),p=t("#expiration"),m=t("#cvc");async function X(){!P||!H||(te(),re(),H.addEventListener("click",()=>{P.click()}),P.addEventListener("click",async()=>{await Q()&&(ae(),ee())}))}function ee(){o||(localStorage.removeItem("cartItems"),window.location.href="/Vitamin/successful-order.html");const r=JSON.parse(localStorage.getItem("cartItems")||"[]");if(r.length===0){console.log("Cart is empty!");return}console.log(o);const s={order:r.map(e=>({product_id:e.id,quantity:e.counts})),user_id:o.user_id};try{J(s).then(e=>{console.log("Order created successfully:",e),localStorage.removeItem("cartItems"),window.location.href="/Vitamin/successful-order.html"})}catch(e){console.error(e)}}function re(){!u||!p||!m||(q(u,{mask:"0000-0000-0000-0000"}),q(p,{mask:"00/00"}),q(m,{mask:"000"}))}function ae(){if(!M||!L||!I||!y||!S||!b||!x||!T||!F||!u||!p||!m)return;const r={firstName:M.value,lastName:L.value,addressFirst:I.value,addressSecond:y.value,city:S.value,state:b.value,zip:x.value,email:T.value,phone:F.value,card:u.value,date:p.value,cvc:m.value};console.log("Order created:",r),localStorage.setItem("orderInfo",JSON.stringify(r))}function te(){if(!(!M||!L||!I||!y||!S||!b||!x||!T||!F||!u||!p||!m)){if(i&&!o){M.value=i.firstName,L.value=i.lastName,I.value=i.addressFirst,y.value=i.addressSecond,S.value=i.city,b.value=i.state,x.value=i.zip,T.value=i.email,F.value=i.phone,u.value=i.card,p.value=i.expiration,m.value=i.cvc;return}o&&(M.value=o.first_name,L.value=o.last_name,I.value=o.address_one,y.value=o.address_two,S.value=o.city,b.value=o.state_province,x.value=o.postal_code,T.value=o.email,F.value=o.phone,u.value=o.card_info.card_number,p.value=o.card_info.card_date,m.value=o.card_info.card_cvv)}}document.addEventListener("DOMContentLoaded",async()=>{B(),Y(),G();const r=t(".deliver-info__subitem_dropdown");r&&(z(r),await X(),V())});A();
