import"./style-C406C8Tq.js";import"./check-auth-CvLvakMh.js";import{J as c}from"./just-validate.es-C73wyOde.js";import{b as f}from"./axios-BrcDDtdF.js";import{a as u}from"./api-client-DO6NzlH2.js";import{A as h}from"./index-CKL1PcRE.js";function p(){const r=document.getElementById("wholesale-registration-file"),t=document.getElementById("wholesale-registration-file-description-pc"),e=document.getElementById("wholesale-registration-file-name"),a=document.getElementById("registration-add-file-btn"),s=document.getElementById("wholesale-registration-submit-btn");r&&r.addEventListener("change",()=>{if(r.files&&r.files.length>0)if(window.innerWidth>=567&&t){const n=r.files[0].name,i=30,o=n.length>i?n.slice(0,i)+"...":n;t.textContent=o}else{const n=r.files[0].name,i=30,o=n.length>i?n.slice(0,i)+"...":n;e.textContent=o,e.style.opacity="1"}}),a&&r&&a.addEventListener("click",()=>{r.click()}),r&&s&&r.addEventListener("change",()=>{s.classList.remove("registration-form__submit_disabled"),s.disabled=!1})}function v(){const r=document.getElementById("auth-card"),t=document.getElementById("regular-reg"),e=document.getElementById("wholesale-reg"),a=document.querySelectorAll(".registration-form__error-message"),s=document.querySelector(".registration__container");if(r&&t&&e){t.addEventListener("click",()=>{e.classList.remove("registration__nav-btn_active"),t.classList.add("registration__nav-btn_active"),r.classList.add("flipped");const i=document.getElementById("regular-registration");i instanceof HTMLFormElement&&i.reset(),a&&a.forEach(l=>{l.innerText=""});const o=document.querySelectorAll(".just-validate-error-label");o&&o.forEach(l=>{l.remove()}),s instanceof HTMLDivElement&&(s.style.height="890px")}),e.addEventListener("click",()=>{e.classList.add("registration__nav-btn_active"),t.classList.remove("registration__nav-btn_active"),r.classList.remove("flipped");const i=document.getElementById("wholesale-registration");i instanceof HTMLFormElement&&i.reset();const o=document.getElementById("wholesale-registration-file-name");o&&(o.innerHTML="Permission",o.style.opacity="0.3");const l=document.getElementById("wholesale-registration-file-description-pc");l&&(l.innerHTML="Wholesale purchase permission",l.style.opacity="0.3");const m=document.getElementById("wholesale-registration-submit-btn");m instanceof HTMLButtonElement&&(m.disabled=!0,m.classList.add("registration-form__submit_disabled")),a&&a.forEach(g=>{g.innerText=""}),s instanceof HTMLDivElement&&(s.style.height="950px")});const n=document.querySelectorAll(".just-validate-error-label");n&&n.forEach(i=>{i.remove()})}}async function d(r){try{const e=await u.post("/auth/register",r);e.status===201&&f.set("refreshToken",e.data.user.refreshToken,{path:"/"})}catch(e){if(e instanceof h&&e.response){const a=document.querySelectorAll(".registration-form__error-message");a&&(e.response.data.message==="Користувач вже зареєстрований"?a.forEach(s=>{s.innerHTML="The user is already registered"}):a.forEach(s=>{s.innerHTML="Error, try again later"}))}return}const t=await u.get("/profile/info");"email"in t.data&&(localStorage.setItem("userInfo",JSON.stringify(t.data)),window.location.href="/Vitamin")}function y(){new c("#regular-registration").addField("#regular-registration-email",[{rule:"required",errorMessage:"Email is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9а-яА-Я."_%+-]+@[a-zA-Zа-яА-Я0-9-.]+\.[a-zA-Zа-яА-Я]{2,}$/u,errorMessage:"Enter a valid email address!"}]).addField("#regular-registration-first-name",[{rule:"required",errorMessage:"Name required"},{rule:"minLength",value:2,errorMessage:"The name must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"The name must not exceed 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"The name must contain only letters"}]).addField("#regular-registration-last-name",[{rule:"required",errorMessage:"Last name required"},{rule:"minLength",value:2,errorMessage:"Last name must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"Last name must not exceed 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"The name must contain only letters"}]).addField("#regular-registration-password",[{rule:"required",errorMessage:"Password required"},{rule:"minLength",value:8,errorMessage:"Password must contain a minimum of 8 characters"},{rule:"maxLength",value:50,errorMessage:"Password must not exceed 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"Must contain uppercase ,lowercase letter, and number"}]).onSuccess(async()=>{const t=document.getElementById("regular-registration"),e=new FormData(t),a={role_type:"regular"};for(let[s,n]of e.entries())a[s]=n;await d(a)})}function L(){new c("#wholesale-registration").addField("#wholesale-registration-email",[{rule:"required",errorMessage:"Email is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9а-яА-Я."_%+-]+@[a-zA-Zа-яА-Я0-9-.]+\.[a-zA-Zа-яА-Я]{2,}$/u,errorMessage:"Enter a valid email address!"}]).addField("#wholesale-registration-first-name",[{rule:"required",errorMessage:"First name is required"},{rule:"minLength",value:2,errorMessage:"First name must be at least 2 characters"},{rule:"maxLength",value:30,errorMessage:"First name must be at most 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"First name must contain only letters"}]).addField("#wholesale-registration-last-name",[{rule:"required",errorMessage:"Last name is required"},{rule:"minLength",value:2,errorMessage:"Last name must be at least 2 characters"},{rule:"maxLength",value:30,errorMessage:"Last name must be at most 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"Last name must contain only letters"}]).addField("#wholesale-registration-password",[{rule:"required",errorMessage:"Password is required"},{rule:"minLength",value:8,errorMessage:"Password must be at least 8 characters"},{rule:"maxLength",value:50,errorMessage:"Password must be at most 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"Must contain uppercase ,lowercase letter, and number"}]).addField("#wholesale-registration-file",[{rule:"required",errorMessage:"File is required"},{validator:()=>{const t=document.querySelector("#wholesale-registration-file");return!t.files||t.files.length===0?!1:["image/jpeg","image/png","image/webp"].includes(t.files[0].type)},errorMessage:"Only image(JPG, PNG, webp) are allowed"}]).onSuccess(async()=>{const t=document.getElementById("wholesale-registration"),e=new FormData(t),a={role_type:"whosale"};for(let[s,n]of e.entries())a[s]=n;await d(a)})}document.addEventListener("DOMContentLoaded",async()=>{p(),v(),y(),L()});
