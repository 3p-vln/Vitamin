import"./style-DF89iUSm.js";import{J as u}from"./just-validate.es-C73wyOde.js";import{a as c,A as g}from"./index-wYSWI2m-.js";import{a as m}from"./api-client-BqRPaJwN.js";function f(){const r=document.getElementById("wholesale-registration-file"),t=document.getElementById("wholesale-registration-file-description-pc"),e=document.getElementById("wholesale-registration-file-name"),a=document.getElementById("registration-add-file-btn"),n=document.getElementById("wholesale-registration-submit-btn");r&&r.addEventListener("change",()=>{r.files&&r.files.length>0&&(window.innerWidth>=567&&t?t.textContent=r.files[0].name:(e.textContent=r.files[0].name,e.style.opacity="1"))}),a&&r&&a.addEventListener("click",()=>{r.click()}),r&&n&&r.addEventListener("change",()=>{n.classList.remove("registration-form__submit_disabled"),n.disabled=!1})}function h(){const r=document.getElementById("auth-card"),t=document.getElementById("regular-reg"),e=document.getElementById("wholesale-reg"),a=document.querySelector(".registration-form__error-message");if(r&&t&&e){t.addEventListener("click",()=>{e.classList.remove("registration__nav-btn_active"),t.classList.add("registration__nav-btn_active"),r.classList.add("flipped");const s=document.getElementById("regular-registration");s instanceof HTMLFormElement&&s.reset(),a instanceof HTMLSpanElement&&(a.innerText="");const i=document.querySelectorAll(".just-validate-error-label");i&&i.forEach(o=>{o.remove()})}),e.addEventListener("click",()=>{e.classList.add("registration__nav-btn_active"),t.classList.remove("registration__nav-btn_active"),r.classList.remove("flipped");const s=document.getElementById("wholesale-registration");s instanceof HTMLFormElement&&s.reset();const i=document.getElementById("wholesale-registration-file-name");i&&(i.innerHTML="Permission",i.style.opacity="0.3");const o=document.getElementById("wholesale-registration-file-description-pc");o&&(o.innerHTML="Wholesale purchase permission",o.style.opacity="0.3");const l=document.getElementById("wholesale-registration-submit-btn");l instanceof HTMLButtonElement&&(l.disabled=!0,l.classList.add("registration-form__submit_disabled")),a instanceof HTMLSpanElement&&(a.innerText="")});const n=document.querySelectorAll(".just-validate-error-label");n&&n.forEach(s=>{s.remove()})}}async function d(r){try{const e=await m.post("/auth/register",r);e.status===201&&c.set("refreshToken",e.data.user.refreshToken,{path:"/"})}catch(e){if(e instanceof g&&e.response){const a=document.querySelector(".registration-form__regular-error-message");a&&(e.response.data.message==="Користувач вже зареєстрований"?a.innerHTML="The user is already registered":a.innerHTML="Error, try again later")}return}const t=await m.get("/profile/info");"email"in t.data&&(localStorage.setItem("userInfo",JSON.stringify(t.data)),window.location.href="/Vitamin")}function p(){new u("#regular-registration").addField("#regular-registration-email",[{rule:"required",errorMessage:"Email is required"},{rule:"email",errorMessage:"Enter a valid email address"}]).addField("#regular-registration-first-name",[{rule:"required",errorMessage:"Name required"},{rule:"minLength",value:2,errorMessage:"The name must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"The name must not exceed 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"The name must contain only letters"}]).addField("#regular-registration-last-name",[{rule:"required",errorMessage:"Last name required"},{rule:"minLength",value:2,errorMessage:"Last name must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"Last name must not exceed 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"The name must contain only letters"}]).addField("#regular-registration-password",[{rule:"required",errorMessage:"Password required"},{rule:"minLength",value:8,errorMessage:"Password must contain a minimum of 8 characters"},{rule:"maxLength",value:50,errorMessage:"Password must not exceed 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"The password must contain at least one uppercase letter, one lowercase letter, and one number"}]).onSuccess(async()=>{const t=document.getElementById("regular-registration"),e=new FormData(t),a={role_type:"regular"};for(let[n,s]of e.entries())a[n]=s;await d(a)})}function v(){new u("#wholesale-registration").addField("#wholesale-registration-email",[{rule:"required",errorMessage:"Email is required"},{rule:"email",errorMessage:"Invalid email format"}]).addField("#wholesale-registration-first-name",[{rule:"required",errorMessage:"First name is required"},{rule:"minLength",value:2,errorMessage:"First name must be at least 2 characters"},{rule:"maxLength",value:30,errorMessage:"First name must be at most 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"First name must contain only letters"}]).addField("#wholesale-registration-last-name",[{rule:"required",errorMessage:"Last name is required"},{rule:"minLength",value:2,errorMessage:"Last name must be at least 2 characters"},{rule:"maxLength",value:30,errorMessage:"Last name must be at most 30 characters"},{rule:"customRegexp",value:/^[A-Za-zА-Яа-яЁё]+$/,errorMessage:"Last name must contain only letters"}]).addField("#wholesale-registration-password",[{rule:"required",errorMessage:"Password is required"},{rule:"minLength",value:6,errorMessage:"Password must be at least 6 characters"},{rule:"maxLength",value:50,errorMessage:"Password must be at most 50 characters"},{rule:"customRegexp",value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,errorMessage:"Password must contain at least one uppercase letter, one lowercase letter, and one number"}]).addField("#wholesale-registration-file",[{rule:"required",errorMessage:"File is required"},{validator:()=>{const t=document.querySelector("#wholesale-registration-file");return!t.files||t.files.length===0?!1:["image/jpeg","image/png","image/webp"].includes(t.files[0].type)},errorMessage:"Only image files (JPG, JPEG, PNG, webp) are allowed"}]).onSuccess(async()=>{const t=document.getElementById("wholesale-registration"),e=new FormData(t),a={role_type:"whosale"};for(let[n,s]of e.entries())a[n]=s;await d(a)})}document.addEventListener("DOMContentLoaded",async()=>{f(),h(),p(),v()});
