import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{g as a,r as l,c as n}from"./use-call-dom-DDNnwvp7.js";import{a as R,k as O,l as k,m as z,i as J}from"./cart-Zl5pb77G.js";import{J as U}from"./just-validate.es-C73wyOde.js";import{I as w}from"./index-yFKSUj0c.js";import"./index-CYnvAbVQ.js";import"./js.cookie-Cj7aMn_Q.js";const L=a(".order-list__prods"),v=a(".order-list__total");function V(){A(),W()}function A(){const r=JSON.parse(localStorage.getItem("cartItems")||"[]");r.length!==0&&L&&(L.innerHTML="",r.forEach(s=>{B(s)}))}async function B(r){if(!L)return;const s=l("div",["prod",`prod_${r.id}`]),e=l("div","prod__img");try{const t=await R(`${r.id}`);if("errors"in t){console.error(t.errors);return}t.type==="Vitamins & Dietary Supplements"&&n(e,"add","prod__img_purple"),t.type==="Minerals"&&n(e,"add","prod__img_green-mint"),t.type==="Prenatal Vitamins"&&n(e,"add","prod__img_pink"),t.type==="Pain Relief"&&n(e,"add","prod__img_blue"),t.type==="Antioxidants"&&n(e,"add","prod__img_orange"),t.type==="Weight Loss"&&n(e,"add","prod__img_dark-blue"),(t.type==="Probiotics"||t.type==="Sale%")&&n(e,"add","prod__img_red"),e.innerHTML=`
    <img src="${t.img}" alt="" />
  `;const f=l("div","prod__count-and-name");f.innerText=`${r.counts} x ${t.name}`;const c=l("p","prod__price"),M=O(t.price,t.discount,r.counts),d=k(t.price,r.counts);t.type==="Sale%"?(n(c,"add","prod__price_sale"),c.innerHTML=`<span>$${d}</span> $${M}`):c.innerText=`$${d}`,s.appendChild(e),s.appendChild(f),s.appendChild(c),L.appendChild(s)}catch(t){console.error(t)}}function W(){if(!v)return;let r=JSON.parse(localStorage.getItem("cartItems")||"[]"),s=0,e,t=0;const f=l("p","order-list__subtotal"),c=l("p","order-list__shopping"),M=l("p","order-list__discount"),d=l("p","order-list__todays-total"),D=a(".accordion__price");r?.length===0&&(d.innerHTML="Today’s Total: <span>$0</span>"),r.forEach(async h=>{try{const i=await R(`${h.id}`);if("errors"in i){console.error(i.errors);return}if(i.type==="Sale%"?(e=O(i.price,i.discount,h.counts),t+=parseFloat(k(i.price,h.counts).replace(/,/g,"").replace(/\s/g,""))-parseFloat(O(i.price,i.discount,h.counts).replace(/,/g,"").replace(/\s/g,""))):e=k(i.price,h.counts),s+=parseFloat(e.replace(/,/g,"").replace(/\s/g,"")),f.innerHTML=`Subtotal <span>$${s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,v.appendChild(f),t!==0&&(M.innerHTML=`Discount <span class="red">-$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,v.appendChild(M)),c.innerHTML="Shipping <span>$9.20</span>",v.appendChild(c),s+=9.2,d.innerHTML=`Today’s Total: <span>$${s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,v.appendChild(d),!D)return;D.innerText=`$${s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}catch(i){console.log(i)}})}const C=a(".accordion"),N=a(".accordion-content");function Z(){!C||!N||C.addEventListener("click",()=>{C.classList.toggle("accordion_active"),N.classList.toggle("accordion-content_active")})}const u=a(".header");function Y(){j()}function j(){E(),window.addEventListener("scroll",E)}function E(){u&&(window.scrollY>50?(u.style.backgroundColor="white",u.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.1)",u.style.transition="background-color 0.3s ease, box-shadow 0.3s ease"):(u.style.backgroundColor="transparent",u.style.boxShadow="none"))}async function G(){return new Promise(r=>{const s=a("#create-order");if(!s)return;const e=new U(s,{focusInvalidField:!0,lockForm:!1,validateBeforeSubmitting:!0});e.addField("#first-name",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Only letters are allowed"}]).addField("#last-name",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Only letters are allowed"}]).addField("#address-line1",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:5,errorMessage:"Must be at least 5 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}\d.,\s]+$/u,errorMessage:"Write correct address"}]).addField("#address-line2",[{rule:"minLength",value:5,errorMessage:"Must be at least 5 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}\d.,\s]+$/u,errorMessage:"Write correct address"}]).addField("#city",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Enter a valid city name"}]).addField("#state",[{rule:"required",errorMessage:"This field is required"}]).addField("#zip",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:3,errorMessage:"Must be at least 3 characters"},{rule:"maxLength",value:10,errorMessage:"Must be less than 10 characters"},{rule:"customRegexp",value:/^\d+$/,errorMessage:"Enter a valid ZIP / Postal Code"}]).addField("#mail",[{rule:"required",errorMessage:"This field is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z]{2,})$/,errorMessage:"Write correct email"}]).addField("#phone",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:4,errorMessage:"Must be at least 4 characters"},{rule:"maxLength",value:15,errorMessage:"Must be less than 15 characters"},{rule:"customRegexp",value:/^\+?\d+$/,errorMessage:"Enter a valid phone number"}]).addField("#card",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:19,errorMessage:"Must be at least 16 characters"}]).addField("#expiration",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:5,errorMessage:"Must be at least 4 characters"}]).addField("#cvc",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:3,errorMessage:"Must be at least 3 characters"}]),e.validate(),e.onSuccess(()=>r(!0)),e.onFail(()=>r(!1))})}const P=a(".create-order-form__btn"),H=a(".order-list__btn"),_=JSON.parse(localStorage.getItem("userInfo")||"[]"),o=JSON.parse(localStorage.getItem("orderInfo")||"[]"),I=a("#first-name"),y=a("#last-name"),S=a("#address-line1"),b=a("#address-line2"),x=a("#city"),T=a("#state"),F=a("#zip"),$=a("#mail"),q=a("#phone"),p=a("#card"),m=a("#expiration"),g=a("#cvc");async function K(){!P||!H||(X(),re(),H.addEventListener("click",()=>{P.click()}),P.addEventListener("click",async()=>{await G()&&(ee(),Q())}))}function Q(){_||(localStorage.removeItem("cartItems"),window.location.href="/Vitamin/successful-order.html");const r=JSON.parse(localStorage.getItem("cartItems")||"[]");if(r.length===0){console.log("Cart is empty!");return}console.log(_);const s={order:r.map(e=>({product_id:e.id,quantity:e.counts})),user_id:_.user_id};try{z(s).then(e=>{console.log("Order created successfully:",e),localStorage.removeItem("cartItems"),window.location.href="/Vitamin/successful-order.html"})}catch(e){console.error(e)}}function X(){!p||!m||!g||(w(p,{mask:"0000 0000 0000 0000"}),w(m,{mask:"00/00"}),w(g,{mask:"000"}))}function ee(){if(!I||!y||!S||!b||!x||!T||!F||!$||!q||!p||!m||!g)return;const r={firstName:I.value,lastName:y.value,addressFirst:S.value,addressSecond:b.value,city:x.value,state:T.value,zip:F.value,email:$.value,phone:q.value,card:p.value,date:m.value,cvc:g.value};console.log("Order created:",r),localStorage.setItem("orderInfo",JSON.stringify(r))}function re(){!I||!y||!S||!b||!x||!T||!F||!$||!q||!p||!m||!g||o&&!_&&(I.value=o.firstName,y.value=o.lastName,S.value=o.addressFirst,b.value=o.addressSecond,x.value=o.city,T.value=o.state,F.value=o.zip,$.value=o.email,q.value=o.phone,p.value=o.card,m.value=o.expiration,g.value=o.cvc)}document.addEventListener("DOMContentLoaded",async()=>{V(),Z(),Y();const r=a(".deliver-info__subitem_dropdown");r&&(J(r),await K())});
