import{g as $,a as h}from"./useApi-DDH4KABI.js";import{g as l,r as c,c as v}from"./useCallDom-cDO4lF47.js";let f=1,u=10,_=6;const m=window.innerWidth;let g;async function A(e){const i=l(e);if(!i)return;const t=await $(!1);if(t.errors)return;const n=t.data;await w(n,i,"white")}function x(){const e=window.innerWidth;e<375?(u=4,_=2):e<768?(u=6,_=6):(u=10,_=10)}async function D(e,i=1,t){x();const n=l(e);if(!n)return;let r=await h(i,u,t);if(r.errors||r.data.length===0){n.innerHTML="<p>Нет товаров в данной категории</p>";return}const a=r.data;await w(a,n,"gray"),m>=768&&L(e,t),m<768&&E(e,t)}async function w(e,i,t){e.forEach(n=>{const r=c("a",["prod-card",`${n.id}`,`prod-card_${t}`]),a=c("div","prod-card__content"),o=c("div","prod-card__img");o.innerHTML=`<picture><img src="${n.img}" /></picture>`;const s=c("div","prod-card__discount");s.innerText=`-${n.discount}%`;const d=c("div",["prod-card__info","info"]),y=c("p","info__category");b(n.type,y),y.innerText=n.type;const C=c("p","info__name");C.innerText=n.name;const P=T(n.price,n.discount),p=c("p","info__price");n.type==="Sale%"?(p.innerHTML=`<span>$${n.price}</span> $${P}`,v(p,"add","info__price_sale")):p.innerText=`$${n.price}`,d.appendChild(y),d.appendChild(C),d.appendChild(p),a.appendChild(o),n.type==="Sale%"&&a.appendChild(s),a.appendChild(d),r.appendChild(a),i.appendChild(r)})}function b(e,i){const t={"Vitamins & Dietary Supplements":"info__category_purple",Minerals:"info__category_green-mint","Prenatal Vitamins":"info__category_purple","Pain Relief":"info__category_blue",Antioxidants:"info__category_orange","Weight Loss":"info__category_dark-blue",Probiotics:"info__category_red","Sale%":"info__category_red"};t[e]&&v(i,"add",t[e])}function T(e,i){const t=parseFloat(e);if(isNaN(t))throw new Error("Invalid price format");return+(t*(1-i/100)).toFixed(2)}function L(e,i){const t=l(e);if(!t||t.children.length===0)return;const n=new IntersectionObserver(async(a,o)=>{a[0].isIntersecting&&(o.disconnect(),await M(e,i),L(e,i))},{threshold:1}),r=t.lastElementChild;r&&n.observe(r)}async function M(e,i){const t=l(e);if(!t)return;i!==g?(f=1,g=i,t.innerHTML=""):f++;const n=await h(f,_,i);n.errors||n.data.length===0||await w(n.data,t,"gray")}async function E(e,i){const t=l(".catalog-list__view-more");if(!t)return;g=i,f=1;let n=await h(1,1,i);if(!W(n)||n.errors)return;const r=n.meta.totalItems,a=l(e);if(!a)return;let o=a.children.length,s=r-o;t.style.display=s>0?"flex":"none",t.replaceWith(t.cloneNode(!0));const d=l(".catalog-list__view-more");d.addEventListener("click",async()=>{s>0&&(await M(e,g),o=a.children.length,s=r-o,d.style.display=s>0?"flex":"none")})}function W(e){return typeof e=="object"&&e!==null&&"data"in e&&Array.isArray(e.data)}export{D as a,A as r};
