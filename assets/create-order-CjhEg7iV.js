import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{g as t,r as c,c as l}from"./use-call-dom-DDNnwvp7.js";import{h as O,j as k,i as J}from"./cart-CaP9Sn4e.js";import{a as z,m as R}from"./use-api-DTQNp6K8.js";import{J as U}from"./just-validate.es-C73wyOde.js";import{I as w}from"./index-yFKSUj0c.js";import{s as V,r as A}from"./stopPreload-BW9xUuEZ.js";const q=t(".order-list__prods"),M=t(".order-list__total");function B(){W(),j()}function W(){const r=JSON.parse(localStorage.getItem("cartItems")||"[]");r.length!==0&&q&&(q.innerHTML="",r.forEach(o=>{Z(o)}))}async function Z(r){if(!q)return;const o=c("div",["prod",`prod_${r.id}`]),e=c("div","prod__img");try{const a=await z(`${r.id}`);if("errors"in a){console.error(a.errors);return}a.type==="Vitamins & Dietary Supplements"&&l(e,"add","prod__img_purple"),a.type==="Minerals"&&l(e,"add","prod__img_green-mint"),a.type==="Prenatal Vitamins"&&l(e,"add","prod__img_pink"),a.type==="Pain Relief"&&l(e,"add","prod__img_blue"),a.type==="Antioxidants"&&l(e,"add","prod__img_orange"),a.type==="Weight Loss"&&l(e,"add","prod__img_dark-blue"),(a.type==="Probiotics"||a.type==="Sale%")&&l(e,"add","prod__img_red"),e.innerHTML=`
    <img src="${a.img}" alt="" />
  `;const v=c("div","prod__count-and-name");v.innerText=`${r.counts} x ${a.name}`;const d=c("p","prod__price"),$=O(a.price,a.discount,r.counts),f=k(a.price,r.counts);a.type==="Sale%"?(l(d,"add","prod__price_sale"),d.innerHTML=`<span>$${f}</span> $${$}`):d.innerText=`$${f}`,o.appendChild(e),o.appendChild(v),o.appendChild(d),q.appendChild(o)}catch(a){console.error(a)}}function j(){if(!M)return;let r=JSON.parse(localStorage.getItem("cartItems")||"[]"),o=0,e,a=0;const v=c("p","order-list__subtotal"),d=c("p","order-list__shopping"),$=c("p","order-list__discount"),f=c("p","order-list__todays-total"),D=t(".accordion__price");r?.length===0&&(f.innerHTML="Today’s Total: <span>$0</span>"),r.forEach(async _=>{try{const n=await z(`${_.id}`);if("errors"in n){console.error(n.errors);return}if(n.type==="Sale%"?(e=O(n.price,n.discount,_.counts),a+=parseFloat(k(n.price,_.counts).replace(/,/g,"").replace(/\s/g,""))-parseFloat(O(n.price,n.discount,_.counts).replace(/,/g,"").replace(/\s/g,""))):e=k(n.price,_.counts),o+=parseFloat(e.replace(/,/g,"").replace(/\s/g,"")),v.innerHTML=`Subtotal <span>$${o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,M.appendChild(v),a!==0&&($.innerHTML=`Discount <span class="red">-$${a.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,M.appendChild($)),d.innerHTML="Shipping <span>$9.20</span>",M.appendChild(d),o+=9.2,f.innerHTML=`Today’s Total: <span>$${o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`,M.appendChild(f),!D)return;D.innerText=`$${o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}catch(n){console.log(n)}})}const C=t(".accordion"),N=t(".accordion-content");function Y(){!C||!N||C.addEventListener("click",()=>{C.classList.toggle("accordion_active"),N.classList.toggle("accordion-content_active")})}const h=t(".header");function G(){K()}function K(){E(),window.addEventListener("scroll",E)}function E(){h&&(window.scrollY>50?(h.style.backgroundColor="white",h.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.1)",h.style.transition="background-color 0.3s ease, box-shadow 0.3s ease"):(h.style.backgroundColor="transparent",h.style.boxShadow="none"))}async function Q(){return new Promise(r=>{const o=t("#create-order");if(!o)return;const e=new U(o,{focusInvalidField:!0,lockForm:!1,validateBeforeSubmitting:!0});e.addField("#first-name",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Only letters are allowed"}]).addField("#last-name",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Only letters are allowed"}]).addField("#address-line1",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:5,errorMessage:"Must be at least 5 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}\d.,\s]+$/u,errorMessage:"Write correct address"}]).addField("#address-line2",[{rule:"minLength",value:5,errorMessage:"Must be at least 5 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}\d.,\s]+$/u,errorMessage:"Write correct address"}]).addField("#city",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:2,errorMessage:"Must be at least 2 characters"},{rule:"maxLength",value:50,errorMessage:"Must be less than 50 characters"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Enter a valid city name"}]).addField("#state",[{rule:"required",errorMessage:"This field is required"}]).addField("#zip",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:3,errorMessage:"Must be at least 3 characters"},{rule:"maxLength",value:10,errorMessage:"Must be less than 10 characters"},{rule:"customRegexp",value:/^\d+$/,errorMessage:"Enter a valid ZIP / Postal Code"}]).addField("#mail",[{rule:"required",errorMessage:"This field is required"},{rule:"customRegexp",value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z]{2,})$/,errorMessage:"Write correct email"}]).addField("#phone",[{rule:"required",errorMessage:"This field is required"},{rule:"maxLength",value:19,errorMessage:"Must be less than 13 characters"}]).addField("#card",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:19,errorMessage:"Must be at least 16 characters"}]).addField("#expiration",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:5,errorMessage:"Must be at least 4 characters"}]).addField("#cvc",[{rule:"required",errorMessage:"This field is required"},{rule:"minLength",value:3,errorMessage:"Must be at least 3 characters"}]),e.validate(),e.onSuccess(()=>r(!0)),e.onFail(()=>r(!1))})}const P=t(".create-order-form__btn"),H=t(".order-list__btn"),s=JSON.parse(localStorage.getItem("userInfo")||"null"),i=JSON.parse(localStorage.getItem("orderInfo")||"null"),L=t("#first-name"),I=t("#last-name"),y=t("#address-line1"),S=t("#address-line2"),b=t("#city"),x=t("#state"),T=t("#zip"),F=t("#mail"),u=t("#phone"),p=t("#card"),m=t("#expiration"),g=t("#cvc");async function X(){!P||!H||(te(),re(),H.addEventListener("click",()=>{P.click()}),P.addEventListener("click",async()=>{await Q()&&(ae(),ee())}))}function ee(){s||(localStorage.removeItem("cartItems"),window.location.href="/Vitamin/successful-order.html");const r=JSON.parse(localStorage.getItem("cartItems")||"[]");if(r.length===0){console.log("Cart is empty!");return}console.log(s);const o={order:r.map(e=>({product_id:e.id,quantity:e.counts})),user_id:s.user_id};try{R(o).then(e=>{console.log("Order created successfully:",e),localStorage.removeItem("cartItems"),window.location.href="/Vitamin/successful-order.html"})}catch(e){console.error(e)}}function re(){!p||!m||!g||!u||(w(p,{mask:"0000-0000-0000-0000"}),w(m,{mask:"00/00"}),w(g,{mask:"000"}),w(u,{mask:"+000 (00) 00 00 000"}))}function ae(){if(!L||!I||!y||!S||!b||!x||!T||!F||!u||!p||!m||!g)return;const r={firstName:L.value,lastName:I.value,addressFirst:y.value,addressSecond:S.value,city:b.value,state:x.value,zip:T.value,email:F.value,phone:u.value,card:p.value,date:m.value,cvc:g.value};console.log("Order created:",r),localStorage.setItem("orderInfo",JSON.stringify(r))}function te(){if(!(!L||!I||!y||!S||!b||!x||!T||!F||!u||!p||!m||!g)&&!(!s&&i)){if(i&&!s){L.value=i.firstName,I.value=i.lastName,y.value=i.addressFirst,S.value=i.addressSecond,b.value=i.city,x.value=i.state,T.value=i.zip,F.value=i.email,u.value=i.phone,p.value=i.card,m.value=i.expiration,g.value=i.cvc;return}if(s){console.log(s),L.value=s.first_name,I.value=s.last_name,y.value=s.address_one,S.value=s.address_two,b.value=s.city,x.value=s.state_province,T.value=s.postal_code,F.value=s.email,u.value=s.phone,p.value=s.card_info.card_number,m.value=s.card_info.card_date,g.value=s.card_info.card_cvv;return}}}document.addEventListener("DOMContentLoaded",async()=>{B(),Y(),G();const r=t(".deliver-info__subitem_dropdown");r&&(J(r),await X(),V())});A();
